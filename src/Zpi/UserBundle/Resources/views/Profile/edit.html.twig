{% extends "FOSUserBundle::layout.html.twig" %}
{% block js %}
<script type="text/javascript" src="{{ asset('jquery-1.6.3.js') }}"></script> 
<script type="text/javascript">
$(document).ready(function()
{
    $('input#fos_user_profile_form_user_email').blur(function(e)
    {
       var email = $(this).val(); //this is the same that saying $('input#idOfTheEmailField').val()
       var url = '{{ path('emailval') }}'; //we are getting the email_validation route.

       $.post(url, { email: email},
         function(data)
         {
             //document.getElementById("chuj").innerHTML=data.reply; //alert("The app says: " + data);
             $('div#emailval').html(data.reply);
         });

    });
    
    $('input#fos_user_profile_form_user_type_1').click(function(e)
    {
        var text = $("label[for='fos_user_profile_form_user_institution']");
        var texthtml = text.html();
        if(texthtml.charAt(texthtml.length-1) == '*')
            return;
        else
        {
            text.html(texthtml + '*');
            $("input#fos_user_profile_form_user_institution'").attr("required", "required");
        }
        var text2 = $("label[for='fos_user_profile_form_user_nipvat']");
        var text2html = text2.html();
        if(text2html.charAt(text2html.length-1) == '*')
            return;
        else
        {    
            text2.html(text2html + '*');
            $("input#fos_user_profile_form_user_nipvat'").attr("required", "required");
        }    
    });
    
    $('input#fos_user_profile_form_user_type_0').click(function(e)
    {
        var text = $("label[for='fos_user_profile_form_user_institution']");
        var texthtml = text.html();
        if(texthtml.charAt(texthtml.length-1) == '*')
        {    
            text.html(texthtml.substr(0, texthtml.length-1));
            $("input#fos_user_profile_form_user_institution'").removeAttr("required");
        }
        else
            return;
        
        var text2 = $("label[for='fos_user_profile_form_user_nipvat']");
        var text2html = text2.html();
        if(text2html.charAt(text2html.length-1) == '*')
        {    
            text2.html(text2html.substr(0, text2html.length-1));
            $("input#fos_user_profile_form_user_nipvat'").removeAttr("required");
        }    
        else
            return; 
    });

}); 


</script>
{% endblock %}
{% block fos_user_content %}
{% include "FOSUserBundle:Profile:edit_content.html.twig" %}
{% endblock fos_user_content %}
